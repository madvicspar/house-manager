@{
    ViewData["Title"] = "Home Page";
}

<div class="text-center">
    <h2>Адрес дома: @Model.Address</h2>

    <h3>Жильцы дома</h3>

    <table>
        <thead>
            <tr>
                <th>ФИО</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var lodger in Model.Lodgers)
            {
                <tr>
                    <td>@lodger.Surname @lodger.Name @lodger.Pathronymic </td>
                    <td>
                        <a href="#" class="edit-link" data-id="@lodger.Id" data-surname="@lodger.Surname" data-name="@lodger.Name" data-patronymic="@lodger.Pathronymic" data-passport="@lodger.PassportNumber">Edit</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <a href="@Url.Action("Create", "Lodger")">Add New Lodger</a>

    @* <button id="openModal">Открыть окно</button> *@

    @* <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            
        </div>
    </div> *@

    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h4>Данные о жильце</h4>
            <form>
                <input type="hidden" id="Id" />
                <div class="form-group">
                    <label for="Surname">Фамилия</label>
                    <input type="text" id="Surname" class="form-control" />
                </div>
                <div class="form-group">
                    <label for="Name">Имя</label>
                    <input type="text" id="Name" class="form-control" />
                </div>
                <div class="form-group">
                    <label for="Pathronymic">Отчество</label>
                    <input type="text" id="Pathronymic" class="form-control" />
                </div>
                <div class="form-group">
                    <label for="PassportNumber">Номер паспорта (без серии)</label>
                    <input type="text" id="PassportNumber" class="form-control" />
                </div>
                <h5>Список квартир</h5>
                <table id="apartment-list">
                    <thead>
                        <tr>
                            <th>Номер квартиры</th>
                            <th>Процент собственности</th>
                            <th>Количество проживающих</th>
                        </tr>
                    </thead>
                    <tbody id="apartment-list-body">
                        <!-- apartments will be listed here -->
                    </tbody>
                </table>

                <button type="submit" class="btn btn-primary">Сохранить</button>
            </form>
        </div>
    </div>
</div>


@section Scripts {
    <script>
        var editButtons = document.querySelectorAll('.edit-link');
        var modal = document.getElementById('editModal');
        var closeModal = modal.querySelector('.close');

        // editButtons.forEach(function (btn) {
        //     btn.addEventListener('click', function () {
        //         var lodgerId = this.dataset.id;

        //         fetch('@Url.Action("Details", "Lodgers")/' + lodgerId)
        //             .then(response => response.text())
        //             .then(data => {
        //                 showPopup(data);
        //             });
        //     });
        // });

        // function showPopup(content) {
        //     // Отображение полученного представления во всплывающем окне
        //     var popup = document.createElement('div');
        //     popup.classList.add('lodger-popup');
        //     popup.innerHTML = content;
        //     document.body.appendChild(popup);
        // }

        // closeModal.addEventListener('click', function () {
        //     modal.style.display = 'none';
        // });

        // window.addEventListener('click', function (event) {
        //     if (event.target === modal) {
        //         modal.style.display = 'none';
        //     }
        // });

        function findLodgerById(id) {
            // You need to implement logic to find the lodger by ID, for example, by making a call to your server
            // This is just a placeholder, you should replace this with actual logic to fetch the lodger data
            return {
                Id: id,
                Name: 'SampleName',
                Surname: 'SampleSurname',
                Pathronymic: 'SamplePathronymic',
                PassportNumber: 'SamplePassportNumber',
                Apartments: [
                    {
                        Id: 1,
                        Number: '101',
                        OwnershipPercentage: 50,
                        ResidentsNumber: 2
                    }
                ]
            };
        };
    </script>
}